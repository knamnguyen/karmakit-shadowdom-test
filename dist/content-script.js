/*! For license information please see content-script.js.LICENSE.txt */
(()=>{"use strict";var e={47:(e,t)=>{t.getPromisableResult=function(e,t,n){var r;void 0===n&&(n={});var o=n.retries,i=void 0===o?10:o,u=n.delay,c=void 0===u?10:u,a=n.shouldReject,l=void 0===a||a,s=null!==(r=n.rejectMessage)&&void 0!==r?r:"Could not get the result after {{ retries }} retries";return new Promise(function(n,r){var o=0,u=function(){var a=e();t(a)?n(a):++o<i?setTimeout(u,c):l?r(new Error(s.replace(/\{\{\s*retries\s*\}\}/g,"".concat(i)))):n(a)};u()})}},479:(e,t,n)=>{var r=n(47),o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)};function i(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(u,c)}a((r=r.apply(e,t||[])).next())})}function u(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=c(0),u.throw=c(1),u.return=c(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}"function"==typeof SuppressedError&&SuppressedError;var c="$",a=":host",l="invalid selector",s=10,f=10,d=function(e){var t,n=e[0],r=e[1];return(t=n)&&(t instanceof Document||t instanceof Element||t instanceof ShadowRoot)&&"string"==typeof r};function h(e,t){return function(e){return e.split(",").map(function(e){return e.trim()})}(e).map(function(e){var n=function(e){return e.split(c).map(function(e){return e.trim()})}(e);return t(n)})}function v(e,t){var n=t?" If you want to select a shadowRoot, use ".concat(t," instead."):"";return"".concat(e," cannot be used with a selector ending in a shadowRoot (").concat(c,").").concat(n)}function m(e){return e instanceof Promise?e:Promise.resolve(e)}function p(){return"You can not select a shadowRoot (".concat(c,") of the document.")}function y(){return"You can not select a shadowRoot (".concat(c,") of a shadowRoot.")}function b(e,t){for(var n,r,o=null,i=e.length,u=0;u<i;u++){if(0===u)if(e[u].length)o=t.querySelector(e[u]);else{if(t instanceof Document)throw new SyntaxError(p());if(t instanceof ShadowRoot)throw new SyntaxError(y());o=(null===(n=t.shadowRoot)||void 0===n?void 0:n.querySelector(e[++u]))||null}else o=(null===(r=o.shadowRoot)||void 0===r?void 0:r.querySelector("".concat(a," ").concat(e[u])))||null;if(null===o)return null}return o}function g(e,t){var n,r=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([],e,!0),o=r.pop();if(!r.length)return t.querySelectorAll(o);var i=b(r,t);return(null===(n=null==i?void 0:i.shadowRoot)||void 0===n?void 0:n.querySelectorAll("".concat(a," ").concat(o)))||null}function w(e,t){if(1===e.length&&!e[0].length){if(t instanceof Document)throw new SyntaxError(p());if(t instanceof ShadowRoot)throw new SyntaxError(y());return t.shadowRoot}var n=b(e,t);return(null==n?void 0:n.shadowRoot)||null}function S(e,t,n){void 0===n&&(n="querySelectorAll");for(var r=h(e,function(e){if(!e[e.length-1].length)throw new SyntaxError(v(n));return e}),o=r.length,i=0;i<o;i++){var u=g(r[i],t);if(null==u?void 0:u.length)return u}return document.querySelectorAll(l)}function E(e,t,n,r){void 0===n&&(n="shadowRootQuerySelector"),void 0===r&&(r="querySelector");for(var o=h(e,function(e){if(e.pop().length)throw new SyntaxError(function(e,t){return"".concat(e," must be used with a selector ending in a shadowRoot (").concat(c,"). If you don't want to select a shadowRoot, use ").concat(t," instead.")}(n,r));return e}),i=o.length,u=0;u<i;u++){var a=w(o[u],t);if(a)return a}return null}function P(e,t,n,o){return i(this,void 0,void 0,function(){return u(this,function(i){return[2,r.getPromisableResult(function(){return S(e,t,"asyncQuerySelectorAll")},function(e){return!!e.length},{retries:n,delay:o,shouldReject:!1})]})})}function x(e,t,n,o){return i(this,void 0,void 0,function(){return u(this,function(i){return[2,r.getPromisableResult(function(){return E(e,t,"asyncShadowRootQuerySelector","asyncQuerySelector")},function(e){return!!e},{retries:n,delay:o,shouldReject:!1})]})})}var R=function(e,t){var n=e.querySelectorAll(t);if(n.length)return n;if(e instanceof Element&&e.shadowRoot){var r=R(e.shadowRoot,t);if(r.length)return r}for(var o=0,i=Array.from(e.querySelectorAll("*"));o<i.length;o++){var u=i[o],c=R(u,t);if(c.length)return c}return document.querySelectorAll(l)},T=function(e,t,n,o){return r.getPromisableResult(function(){return R(e,t)},function(e){return!!e.length},{retries:n,delay:o,shouldReject:!1})};function _(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(this,void 0,void 0,function(){var t,n,r,o,i;return u(this,function(u){switch(u.label){case 0:return d(e)?(t=e[0],n=e[1],r=e[2],[4,P(n,t,(null==r?void 0:r.retries)||s,(null==r?void 0:r.delay)||f)]):[3,2];case 1:return[2,u.sent()];case 2:return o=e[0],i=e[1],[2,P(o,document,(null==i?void 0:i.retries)||s,(null==i?void 0:i.delay)||f)]}})})}function k(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(this,void 0,void 0,function(){var t,n,r,o,i;return u(this,function(u){switch(u.label){case 0:return d(e)?(t=e[0],n=e[1],r=e[2],[4,x(n,t,(null==r?void 0:r.retries)||s,(null==r?void 0:r.delay)||f)]):[3,2];case 1:return[2,u.sent()];case 2:return o=e[0],i=e[1],[2,x(o,document,(null==i?void 0:i.retries)||s,(null==i?void 0:i.delay)||f)]}})})}!function(){function e(e,t){e instanceof Node||e instanceof Promise?(this._element=e,this._asyncParams=o({retries:s,delay:f},t||{})):(this._element=document,this._asyncParams=o({retries:s,delay:f},e||{}))}Object.defineProperty(e.prototype,"element",{get:function(){return m(this._element).then(function(e){return e instanceof NodeList?e[0]||null:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$",{get:function(){var t=this;return new e(m(this._element).then(function(e){return e instanceof Document||e instanceof ShadowRoot||null===e||e instanceof NodeList&&0===e.length?null:e instanceof NodeList?k(e[0],c,t._asyncParams):k(e,c,t._asyncParams)}),this._asyncParams)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"all",{get:function(){return m(this._element).then(function(e){return e instanceof NodeList?e:document.querySelectorAll(l)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asyncParams",{get:function(){return this._asyncParams},enumerable:!1,configurable:!0}),e.prototype.eq=function(e){return i(this,void 0,void 0,function(){return u(this,function(t){return[2,m(this._element).then(function(t){return t instanceof NodeList&&t[e]||null})]})})},e.prototype.query=function(t){var n=this;return new e(m(this._element).then(function(e){return null===e||e instanceof NodeList&&0===e.length?null:e instanceof NodeList?_(e[0],t,n._asyncParams):_(e,t,n._asyncParams)}),this._asyncParams)},e.prototype.deepQuery=function(t){var n=this;return new e(m(this._element).then(function(e){return null===e||e instanceof NodeList&&0===e.length?null:e instanceof NodeList?Promise.race(Array.from(e).map(function(e){return T(e,t,n._asyncParams.retries,n._asyncParams.delay)})):T(e,t,n._asyncParams.retries,n._asyncParams.delay)}),this._asyncParams)}}();t.Es=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(this,void 0,void 0,function(){var t,n,r,o,i;return u(this,function(u){switch(u.label){case 0:return d(e)?(t=e[0],n=e[1],r=e[2],[4,T(t,n,(null==r?void 0:r.retries)||s,(null==r?void 0:r.delay)||f)]):[3,2];case 1:case 3:return[2,u.sent()[0]||null];case 2:return o=e[0],i=e[1],[4,T(document,o,(null==i?void 0:i.retries)||s,(null==i?void 0:i.delay)||f)]}})})}}},t={},n=function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(479);function r(){var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",u=n.toStringTag||"@@toStringTag";function c(n,r,i,u){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return o(s,"_invoke",function(n,r,o){var i,u,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,u=0,c=e,d.n=n,a}};function h(n,r){for(u=n,c=r,t=0;!f&&l&&!o&&t<s.length;t++){var o,i=s[t],h=d.p,v=i[2];n>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(u=0,d.v=r,d.n=i[1]):h<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,d.n=v,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&h(s,v),u=s,c=v;(t=u<2?e:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),h(u,c)):d.n=c:d.v=c);try{if(l=2,i){if(u||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=i.return)&&t.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=e}else if((t=(f=d.n<0)?c:n.call(r,d))!==a)break}catch(t){i=e,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,i,u),!0),s}var a={};function l(){}function s(){}function f(){}t=Object.getPrototypeOf;var d=[][i]?t(t([][i]())):(o(t={},i,function(){return this}),t),h=f.prototype=l.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,u,"GeneratorFunction")),e.prototype=Object.create(h),e}return s.prototype=f,o(h,"constructor",f),o(f,"constructor",s),s.displayName="GeneratorFunction",o(f,u,"GeneratorFunction"),o(h),o(h,u,"Generator"),o(h,i,function(){return this}),o(h,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:v}})()}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){function u(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(u("next",0),u("throw",1),u("return",2))},o(e,t,n,r)}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){a=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(a)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,o,i,u){try{var c=e[i](u),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function a(){var e;return e=r().m(function e(){var t,o,u,c,a,l,s,f,d,h,v,m,p;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Starting Reddit comment interaction..."),console.log("Looking for comment button..."),e.n=1,(0,n.Es)('faceplate-tracker[noun="add_comment_button"]',{retries:5,delay:1e3});case 1:if(t=e.v){e.n=2;break}throw new Error("Comment button not found");case 2:return console.log("Found comment button:",t),console.log("Comment button attributes:",{source:t.getAttribute("source"),action:t.getAttribute("action"),noun:t.getAttribute("noun")}),console.log("Clicking comment button..."),t.focus(),t.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.n=3,new Promise(function(e){return setTimeout(e,50)});case 3:return t.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),t.click(),console.log("Waiting for comment box to appear..."),e.n=4,new Promise(function(e){return setTimeout(e,2e3)});case 4:console.log("Looking for comment text input..."),o=null,e.p=5,console.log("Searching for the expanded text input field..."),o=null,u=0,c=['[placeholder*="conversation"]','[contenteditable="true"]',"textarea",'[role="textbox"]'];case 6:if(!(u<c.length)){e.n=12;break}return a=c[u],e.p=7,console.log("Trying selector: ".concat(a)),e.n=8,(0,n.Es)(a,{retries:1,delay:500});case 8:if(!(o=e.v)){e.n=9;break}if(console.log("Found text input with selector: ".concat(a),o),!(o.offsetHeight>50)){e.n=9;break}return e.a(3,12);case 9:e.n=11;break;case 10:e.p=10,v=e.v,console.log("Selector ".concat(a," failed:"),v.message);case 11:u++,e.n=6;break;case 12:e.n=14;break;case 13:e.p=13,m=e.v,console.log("Text input search encountered error (not critical):",m.message);case 14:if(o){e.n=17;break}return console.log("Shadow DOM search failed, trying manual DOM search..."),l=new Promise(function(e){setTimeout(function(){return e(null)},5e3)}),s=new Promise(function(e){var t=new MutationObserver(function(n){var r,o=i(n);try{for(o.s();!(r=o.n()).done;){var u,c=i(r.value.addedNodes);try{for(c.s();!(u=c.n()).done;){var a=u.value;if(a.nodeType===Node.ELEMENT_NODE){var l=a.querySelector?a.querySelector("textarea"):null;if(l)return t.disconnect(),void e(l)}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}});t.observe(document.body,{childList:!0,subtree:!0});var n=document.querySelector("textarea");if(n)return t.disconnect(),void e(n)}),e.n=15,Promise.race([s,l]);case 15:if(!(o=e.v)){e.n=16;break}console.log("Found text input via manual search:",o),e.n=17;break;case 16:throw new Error("Comment text input not found after click");case 17:return console.log("Focusing and typing sample comment..."),console.log("Text input element type:",o.tagName),console.log("Text input contenteditable:",o.contentEditable),o.focus(),o.click(),o.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),o.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),o.dispatchEvent(new FocusEvent("focus",{bubbles:!0})),o.dispatchEvent(new MouseEvent("click",{bubbles:!0})),e.n=18,new Promise(function(e){return setTimeout(e,1e3)});case 18:return f="This is a sample comment","TEXTAREA"===o.tagName||"INPUT"===o.tagName?(console.log("Working with form input element"),o.value="",o.value=f,o.dispatchEvent(new Event("input",{bubbles:!0})),o.dispatchEvent(new Event("change",{bubbles:!0}))):"true"===o.contentEditable?(console.log("Working with contenteditable element"),o.innerText="",o.innerText=f,d=document.createRange(),h=window.getSelection(),d.selectNodeContents(o),d.collapse(!1),h.removeAllRanges(),h.addRange(d),o.dispatchEvent(new InputEvent("input",{bubbles:!0,data:f,inputType:"insertText"}))):(console.log("Working with generic element"),o.textContent=f,o.dispatchEvent(new InputEvent("input",{bubbles:!0,data:f}))),console.log("Sample comment typed successfully!"),e.a(2,{commentButton:t.outerHTML.substring(0,100)+"...",textInput:o.outerHTML.substring(0,100)+"...",sampleText:f});case 19:throw e.p=19,p=e.v,console.error("Error in addSampleCommentToReddit:",p),p;case 20:return e.a(2)}},e,null,[[7,10],[5,13],[0,19]])}),a=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function u(e){c(i,r,o,u,a,"next",e)}function a(e){c(i,r,o,u,a,"throw",e)}u(void 0)})},a.apply(this,arguments)}console.log("Reddit Comment Helper content script loaded"),chrome.runtime.onMessage.addListener(function(e,t,n){if(console.log("Content script received message:",e),"addSampleComment"===e.action)return function(){return a.apply(this,arguments)}().then(function(e){console.log("Add comment result:",e),n({success:!0,result:e})}).catch(function(e){console.error("Add comment error:",e),n({success:!1,error:e.message})}),!0}),console.log("Reddit Comment Helper content script ready")})();