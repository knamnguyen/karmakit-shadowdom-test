import{getPromisableResult as n}from"get-promisable-result";var t=function(){return t=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},t.apply(this,arguments)};function e(n,t,e,r){return new(e||(e=Promise))((function(o,u){function i(n){try{l(r.next(n))}catch(n){u(n)}}function a(n){try{l(r.throw(n))}catch(n){u(n)}}function l(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(i,a)}l((r=r.apply(n,t||[])).next())}))}function r(n,t){var e,r,o,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(l){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(u=0)),u;)try{if(e=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,r=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=t.call(n,u)}catch(n){a=[6,n],r=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}"function"==typeof SuppressedError&&SuppressedError;var o="$",u=":host",i="invalid selector",a=10,l=10,c=function(n){var t,e=n[0],r=n[1];return(t=e)&&(t instanceof Document||t instanceof Element||t instanceof ShadowRoot)&&"string"==typeof r};function s(n,t){return function(n){return n.split(",").map((function(n){return n.trim()}))}(n).map((function(n){var e=function(n){return n.split(o).map((function(n){return n.trim()}))}(n);return t(e)}))}function f(n,t){var e=t?" If you want to select a shadowRoot, use ".concat(t," instead."):"";return"".concat(n," cannot be used with a selector ending in a shadowRoot (").concat(o,").").concat(e)}function d(n){return n instanceof Promise?n:Promise.resolve(n)}function h(){return"You can not select a shadowRoot (".concat(o,") of the document.")}function y(){return"You can not select a shadowRoot (".concat(o,") of a shadowRoot.")}function v(n,t){for(var e,r,o=null,i=n.length,a=0;a<i;a++){if(0===a)if(n[a].length)o=t.querySelector(n[a]);else{if(t instanceof Document)throw new SyntaxError(h());if(t instanceof ShadowRoot)throw new SyntaxError(y());o=(null===(e=t.shadowRoot)||void 0===e?void 0:e.querySelector(n[++a]))||null}else o=(null===(r=o.shadowRoot)||void 0===r?void 0:r.querySelector("".concat(u," ").concat(n[a])))||null;if(null===o)return null}return o}function p(n,t){var e,r=function(n,t,e){if(e||2===arguments.length)for(var r,o=0,u=t.length;o<u;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return n.concat(r||Array.prototype.slice.call(t))}([],n,!0),o=r.pop();if(!r.length)return t.querySelectorAll(o);var i=v(r,t);return(null===(e=null==i?void 0:i.shadowRoot)||void 0===e?void 0:e.querySelectorAll("".concat(u," ").concat(o)))||null}function m(n,t){if(1===n.length&&!n[0].length){if(t instanceof Document)throw new SyntaxError(h());if(t instanceof ShadowRoot)throw new SyntaxError(y());return t.shadowRoot}var e=v(n,t);return(null==e?void 0:e.shadowRoot)||null}function w(n,t,e,r){void 0===e&&(e="querySelector"),void 0===r&&(r="shadowRootQuerySelector");for(var o=s(n,(function(n){if(!n[n.length-1].length)throw new SyntaxError(f(e,r));return n})),u=o.length,i=0;i<u;i++){var a=v(o[i],t);if(a)return a}return null}function g(n,t,e){void 0===e&&(e="querySelectorAll");for(var r=s(n,(function(n){if(!n[n.length-1].length)throw new SyntaxError(f(e));return n})),o=r.length,u=0;u<o;u++){var a=p(r[u],t);if(null==a?void 0:a.length)return a}return document.querySelectorAll(i)}function b(n,t,e,r){void 0===e&&(e="shadowRootQuerySelector"),void 0===r&&(r="querySelector");for(var u=s(n,(function(n){if(n.pop().length)throw new SyntaxError(function(n,t){return"".concat(n," must be used with a selector ending in a shadowRoot (").concat(o,"). If you don't want to select a shadowRoot, use ").concat(t," instead.")}(e,r));return n})),i=u.length,a=0;a<i;a++){var l=m(u[a],t);if(l)return l}return null}function S(t,o,u,i){return e(this,void 0,void 0,(function(){return r(this,(function(e){return[2,n((function(){return w(t,o,"asyncQuerySelector","asyncShadowRootQuerySelector")}),(function(n){return!!n}),{retries:u,delay:i,shouldReject:!1})]}))}))}function R(t,o,u,i){return e(this,void 0,void 0,(function(){return r(this,(function(e){return[2,n((function(){return g(t,o,"asyncQuerySelectorAll")}),(function(n){return!!n.length}),{retries:u,delay:i,shouldReject:!1})]}))}))}function P(t,o,u,i){return e(this,void 0,void 0,(function(){return r(this,(function(e){return[2,n((function(){return b(t,o,"asyncShadowRootQuerySelector","asyncQuerySelector")}),(function(n){return!!n}),{retries:u,delay:i,shouldReject:!1})]}))}))}var _=function(n,t){var e=n.querySelectorAll(t);if(e.length)return e;if(n instanceof Element&&n.shadowRoot){var r=_(n.shadowRoot,t);if(r.length)return r}for(var o=0,u=Array.from(n.querySelectorAll("*"));o<u.length;o++){var a=u[o],l=_(a,t);if(l.length)return l}return document.querySelectorAll(i)},q=function(t,e,r,o){return n((function(){return _(t,e)}),(function(n){return!!n.length}),{retries:r,delay:o,shouldReject:!1})};function x(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n[0],r=n[1];return"string"==typeof e?w(e,document):w(r,e)}function A(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n[0],r=n[1];return"string"==typeof e?_(document,e)[0]||null:_(e,r)[0]||null}function j(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n[0],r=n[1];return"string"==typeof e?g(e,document):g(r,e)}function E(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n[0],r=n[1];return"string"==typeof e?_(document,e):_(e,r)}function N(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n[0],r=n[1];return"string"==typeof e?b(e,document):b(r,e)}function L(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(this,void 0,void 0,(function(){var t,e,o,u,i;return r(this,(function(r){switch(r.label){case 0:return c(n)?(t=n[0],e=n[1],o=n[2],[4,S(e,t,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||l)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return u=n[0],i=n[1],[4,S(u,document,(null==i?void 0:i.retries)||a,(null==i?void 0:i.delay)||l)]}}))}))}function O(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(this,void 0,void 0,(function(){var t,e,o,u,i;return r(this,(function(r){switch(r.label){case 0:return c(n)?(t=n[0],e=n[1],o=n[2],[4,q(t,e,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||l)]):[3,2];case 1:case 3:return[2,r.sent()[0]||null];case 2:return u=n[0],i=n[1],[4,q(document,u,(null==i?void 0:i.retries)||a,(null==i?void 0:i.delay)||l)]}}))}))}function Q(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(this,void 0,void 0,(function(){var t,e,o,u,i;return r(this,(function(r){switch(r.label){case 0:return c(n)?(t=n[0],e=n[1],o=n[2],[4,R(e,t,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||l)]):[3,2];case 1:return[2,r.sent()];case 2:return u=n[0],i=n[1],[2,R(u,document,(null==i?void 0:i.retries)||a,(null==i?void 0:i.delay)||l)]}}))}))}function k(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(c(n)){var e=n[0],r=n[1],o=n[2];return q(e,r,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||l)}var u=n[0],i=n[1];return q(document,u,(null==i?void 0:i.retries)||a,(null==i?void 0:i.delay)||l)}function D(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(this,void 0,void 0,(function(){var t,e,o,u,i;return r(this,(function(r){switch(r.label){case 0:return c(n)?(t=n[0],e=n[1],o=n[2],[4,P(e,t,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||l)]):[3,2];case 1:return[2,r.sent()];case 2:return u=n[0],i=n[1],[2,P(u,document,(null==i?void 0:i.retries)||a,(null==i?void 0:i.delay)||l)]}}))}))}var I=function(){function n(n,e){n instanceof Node||n instanceof Promise?(this._element=n,this._asyncParams=t({retries:a,delay:l},e||{})):(this._element=document,this._asyncParams=t({retries:a,delay:l},n||{}))}return Object.defineProperty(n.prototype,"element",{get:function(){return d(this._element).then((function(n){return n instanceof NodeList?n[0]||null:n}))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"$",{get:function(){var t=this;return new n(d(this._element).then((function(n){return n instanceof Document||n instanceof ShadowRoot||null===n||n instanceof NodeList&&0===n.length?null:n instanceof NodeList?D(n[0],o,t._asyncParams):D(n,o,t._asyncParams)})),this._asyncParams)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"all",{get:function(){return d(this._element).then((function(n){return n instanceof NodeList?n:document.querySelectorAll(i)}))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"asyncParams",{get:function(){return this._asyncParams},enumerable:!1,configurable:!0}),n.prototype.eq=function(n){return e(this,void 0,void 0,(function(){return r(this,(function(t){return[2,d(this._element).then((function(t){return t instanceof NodeList&&t[n]||null}))]}))}))},n.prototype.query=function(t){var e=this;return new n(d(this._element).then((function(n){return null===n||n instanceof NodeList&&0===n.length?null:n instanceof NodeList?Q(n[0],t,e._asyncParams):Q(n,t,e._asyncParams)})),this._asyncParams)},n.prototype.deepQuery=function(t){var e=this;return new n(d(this._element).then((function(n){return null===n||n instanceof NodeList&&0===n.length?null:n instanceof NodeList?Promise.race(Array.from(n).map((function(n){return q(n,t,e._asyncParams.retries,e._asyncParams.delay)}))):q(n,t,e._asyncParams.retries,e._asyncParams.delay)})),this._asyncParams)},n}();export{I as AsyncSelector,O as asyncDeepQuerySelector,k as asyncDeepQuerySelectorAll,L as asyncQuerySelector,Q as asyncQuerySelectorAll,D as asyncShadowRootQuerySelector,A as deepQuerySelector,E as deepQuerySelectorAll,x as querySelector,j as querySelectorAll,N as shadowRootQuerySelector};
